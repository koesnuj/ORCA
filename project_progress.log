# 프로젝트 진행 로그 - TMS v2
날짜: 2025-11-28
마지막 작업: Bulk Select/Edit 기능 추가 및 스크롤 구조 개선

## 1. 프로젝트 개요
- **목표:** TestRail을 대체할 테스트 관리 시스템 (TMS) 구축
- **기술 스택:**
  - 프론트엔드: React + TypeScript + Vite + Tailwind CSS v3.4.1
  - 백엔드: Node.js + Express
  - 데이터베이스: SQLite (Prisma ORM)
  - 인증: JWT (Access Token)
  - 아이콘: Lucide React
  - 테스트: Playwright (E2E)

## 2. 구현된 기능 (타임라인)

### 1단계: 초기화 및 인증
- [x] Git 저장소 설정 (https://github.com/koesnuj/TMS_v2)
- [x] 백엔드/프론트엔드 프로젝트 구조 설정
- [x] 사용자 모델 (User, 역할: USER/ADMIN, 상태: PENDING/ACTIVE/REJECTED)
- [x] 인증 API (회원가입, 로그인, 내 정보)
- [x] 관리자 API (사용자 승인, 사용자 목록)
- [x] 프론트엔드 인증 페이지 (로그인, 회원가입) & AuthContext

### 2단계: 테스트 케이스 관리
- [x] 폴더 모델 (계층 구조)
- [x] 테스트케이스 모델 (필드: 제목, 설명, 전제조건, 단계, 우선순위 등)
- [x] 폴더 API (트리 뷰, 생성)
- [x] 테스트케이스 API (생성, 폴더별 목록 조회)
- [x] CSV 가져오기 API (헤더 매핑을 통한 대량 생성)
- [x] 프론트엔드 UI:
  - FolderTree 컴포넌트 (재귀적)
  - TestCasesPage (분할 뷰: 트리 + 리스트)
  - CreateTestCaseModal (단일 생성)
  - CsvImportModal (대량 생성)

### 3단계: 테스트 계획 및 실행
- [x] 플랜 모델 (이름, 설명, 상태, 생성자)
- [x] 플랜 아이템 모델 (플랜 <-> 테스트케이스 연결, 결과 저장: PASS/FAIL 등)
- [x] 플랜 API:
  - 플랜 생성 (트랜잭션: 플랜 + 플랜 아이템)
  - 플랜 목록 (진행률 % 및 상태 카운트 계산)
  - 플랜 상세 조회 (아이템 포함)
- [x] **테스트 실행 기능**:
  - **개별 업데이트**: `PATCH /api/plans/:planId/items/:itemId` (결과, 메모)
  - **벌크 업데이트**: `PATCH /api/plans/:planId/items/bulk` (여러 항목 결과 일괄 변경)
  - **자동 링크**: 메모 내 URL을 자동으로 클릭 가능한 링크로 변환
- [x] 프론트엔드 UI:
  - PlansPage (진행률 바가 포함된 목록 뷰)
  - CreatePlanPage (테스트케이스 검색 및 선택)
  - **PlanDetailPage (실행 UI)**:
    - 인터랙티브 상태 드롭다운 (PASS/FAIL/BLOCK/NOT_RUN)
    - 메모 모달 (URL 지원 텍스트 영역)
    - 벌크 액션 바 (전체 선택, 일괄 업데이트)
    - 실시간 진행률 바 업데이트

### 4단계: UI/UX 전면 리디자인 (2025-11-28)
- [x] **디자인 시스템 구축**:
  - UI 컴포넌트 라이브러리 생성 (`Button`, `Card`, `Badge`, `Input`)
  - 5가지 버튼 변형 (primary, secondary, outline, ghost, danger)
  - 로딩 상태 및 아이콘 지원
  - 6가지 Badge 색상 (success, warning, error, info, neutral, primary)
  
- [x] **레이아웃 전환**:
  - 상단 네비게이션 → **좌측 사이드바(Sidebar)** 구조로 변경
  - TestRail/Jira 스타일의 전문적인 SaaS 레이아웃
  - `Sidebar.tsx`: 좌측 고정 네비게이션 (프로젝트, 시스템 섹션 분리)
  - `Header.tsx`: 상단 검색 및 알림 바
  - `Layout.tsx`: Sidebar + Header 통합 레이아웃

- [x] **색상 팔레트 변경**:
  - 기존: Blue 테마 (#2b73b7)
  - 신규: **Slate(배경/텍스트) + Indigo(브랜드 컬러)** 조합
  - 부드럽고 눈의 피로도를 줄이는 색상 체계

- [x] **페이지별 리디자인**:
  - `TestCasesPage`: 좌측 폴더 트리 + 우측 테이블, 새로운 Card 기반 레이아웃
  - `PlansPage`: 깔끔한 테이블 뷰, 진행률 바 시각화 개선 (`max-w-[1800px]`)
  - `CreatePlanPage`: 체크박스 선택 UI 개선, 검색 기능 강화 (`max-w-[1600px]`)
  - `PlanDetailPage`: 실행 UI 개선, 벌크 액션 바 스타일링
  - `AdminPage`: 사용자 관리 테이블 및 카드 디자인 개선
  - `LoginPage`: 중앙 정렬 로그인 카드, 아이콘 추가
  - `RegisterPage`: 회원가입 UI 통일성 확보

- [x] **아이콘 시스템**:
  - `lucide-react` 도입 (모던한 아웃라인 스타일)
  - 네비게이션, 버튼, 폼 입력 등 전역적으로 일관성 있게 적용

- [x] **기술적 개선**:
  - Tailwind CSS 버전 이슈 해결 (v4 → v3.4.1 다운그레이드)
  - PostCSS 설정 최적화
  - 컴포넌트 재사용성 극대화

- [x] **반응형 레이아웃 적용 (2025-11-28 추가)**:
  - 기존 문제: 중앙 콘텐츠가 `max-w-7xl` (1280px)로 고정되어 넓은 화면에서 공간 활용 미흡
  - 해결책: 
    - 일반 페이지: `w-full + max-w-[1800px]` (PlansPage, PlanDetailPage, AdminPage)
    - 폼 페이지: `w-full + max-w-[1600px]` (CreatePlanPage)
    - 분할 뷰: 전체 너비 활용 (TestCasesPage)
  - 좌측 Sidebar는 `w-64` (256px) 고정폭 유지
  - 우측 콘텐츠 영역은 `flex-1`로 유동적 확장
  - 화면 크기별 자동 조정:
    - 1920px: 콘텐츠 1664px (전체 사용)
    - 2560px: 콘텐츠 1800px (max-w 제한, 좌우 여백 증가)
  - 레이아웃 가이드 문서 생성: `frontend/LAYOUT_GUIDE.md`

- [x] **3단 레이아웃 UI 구현 (2025-11-28 추가)**:
  - **참고**: Testiny 스타일의 Test Run 실행 화면
  - **구조**: 
    - 좌측 패널 (320px): Test Run 정보, Progress Summary, Stats, Filter
    - 중앙 테이블 (flex-1): 테스트 케이스 목록, 클릭 가능한 행, 검색 기능
    - 우측 패널 (480px): 슬라이드 인 디테일 패널 (선택 시 열림)
  - **주요 기능**:
    - 테이블 행 클릭 → 우측 패널 열림
    - 선택된 행 하이라이트 (`bg-indigo-50` + `border-l-4`)
    - 패널에서 Assignee/Status 변경 → 테이블 즉시 반영
    - ESC 키 또는 배경 클릭 → 패널 닫기
    - 슬라이드 애니메이션 (`translate-x-0` / `translate-x-full`)
  - **새 컴포넌트**:
    - `TestCaseDetailPanel.tsx`: 우측 슬라이드 패널 (480px, fixed right)
    - `PlanDetailPageNew.tsx`: 3단 레이아웃 페이지 (기존 PlanDetailPage 대체)
  - **디테일 패널 내용**:
    - Test Case ID, Title, Priority Badge
    - Assignee 드롭다운 (pill 형태, indigo-500)
    - Result/Status 드롭다운 (pill 형태, 색상별 구분)
    - Precondition, Steps (번호 매김), Expected Result
    - Comment (textarea, blur 시 자동 저장)
    - Last executed 시간
  - **UX 개선**:
    - Backdrop (반투명 배경, `bg-black/20`)
    - 슬라이드 애니메이션 (300ms ease-in-out)
    - 검색 & 필터 실시간 반영
    - Progress Bar 애니메이션
  - **문서**: `frontend/THREE_COLUMN_LAYOUT_GUIDE.md` 생성

- [x] **3-컬럼 레이아웃 UI 재구현 (2025-11-28 최종)**:
  - **방식 변경**: 슬라이드 팝업 → Flexbox 컬럼 기반 레이아웃
  - **구조**:
    - 좌측 컬럼 (260px 고정): Test Runs 목록, 현재 Run 강조
    - 중앙 컬럼 (flex-grow): Test Run Info + Test Cases 테이블
    - 우측 컬럼 (420px 고정, 조건부): Test Case 디테일 (선택 시만 렌더링)
  - **핵심 특징**:
    - 우측 패널이 나타나면 중앙 테이블 폭이 자동으로 줄어듦
    - 슬라이드 애니메이션 없음 (즉시 나타남/사라짐)
    - Backdrop 없음 (컬럼 방식)
    - 각 컬럼마다 독립적인 스크롤
  - **좌측 패널**:
    - 전체 Test Runs 목록 표시
    - 현재 선택된 Run 하이라이트 (`bg-indigo-50` + `border-l-4`)
    - 각 Run의 Progress Bar 표시
    - Run 클릭 시 중앙 테이블 변경 + 우측 패널 닫기
  - **중앙 패널 상단 (Test Run Info)**:
    - Run 이름, 설명, Status Badge
    - Stats 한 줄 표시 (Passed, Failed, In Progress, Blocked)
    - Overall Progress Bar
  - **우측 패널 (조건부 렌더링)**:
    - `selectedItem`이 null이 아닐 때만 렌더링
    - X 버튼 또는 ESC 키로 닫기
    - Assignee/Status 드롭다운 (pill 형태)
    - Precondition, Steps, Expected Result, Comment
  - **새 컴포넌트**:
    - `TestCaseDetailColumn.tsx`: 우측 디테일 컬럼 (슬라이드 없음)
    - `PlanDetailPage3Column.tsx`: 3-컬럼 레이아웃 메인 페이지
  - **반응형 고려**:
    - 데스크톱: 3-컬럼 유지
    - 태블릿/모바일: 우측 패널을 세로 스택 또는 전체 화면 모달로 전환 가능
  - **장점**:
    - 레이아웃 안정성 (팝업이 아니라 컬럼)
    - 공간 활용 (중앙과 우측이 공존)
    - 성능 (조건부 렌더링)
    - 일관성 (모든 컬럼 같은 높이)
  - **문서**: `frontend/THREE_COLUMN_RESPONSIVE_GUIDE.md` 생성

- [x] **스크롤 동작 개선 (2025-11-28 추가)**:
  - 좌측+중앙을 하나의 래퍼로 묶어 함께 스크롤되도록 개선
  - 우측 패널을 `sticky top-0 h-screen`으로 화면에 고정
  - 좌측/중앙 스크롤 시 우측 패널은 움직이지 않음
  - 각 컬럼의 스크롤이 독립적으로 작동
  - **문서**: `frontend/FIXED_RIGHT_PANEL_LAYOUT_GUIDE.md` 생성

- [x] **도넛 차트 기반 Summary 섹션 구현 (2025-11-28 최종)**:
  - **참고 디자인**: Testiny의 Summary 섹션 (도넛 차트 + 상태 요약 + Team/Details 탭)
  - **새 컴포넌트**:
    - `DonutChart.tsx`: SVG 기반 도넛 차트 (중앙에 완료율 %)
    - `RunSummary.tsx`: Summary 섹션 전체 컴포넌트
  - **레이아웃 구조**:
    - 좌측: 도넛 차트 + 상태별 카운트 리스트 (Failed, Blocked, In Progress, Not Run, Passed)
    - 구분선 (세로)
    - 우측: Team / Details 탭
  - **도넛 차트**:
    - SVG로 직접 구현 (외부 라이브러리 불필요)
    - 세그먼트별 색상: PASS(녹색), FAIL(빨강), IN_PROGRESS(노랑), BLOCK(회색)
    - 중앙에 전체 완료율 표시 (XX% COMPLETE)
    - 하단에 "N of M test cases done" 텍스트
  - **상태 리스트**:
    - 각 상태별 아이콘, 라벨, 카운트, 퍼센트 표시
    - 색상: NOT RUN(회색), IN PROGRESS(노랑), PASS(녹색), FAIL(빨강), BLOCKED(진한 회색)
  - **Team 탭**:
    - 할당된 팀 멤버 목록
    - 각 멤버의 프로필 아이콘 (이니셜)
    - 할당된 테스트 케이스 수 표시
  - **Details 탭**:
    - Test Plan 이름
    - Description
    - Created By
    - Created Date
    - Total Test Cases
  - **스타일**:
    - 카드 형태 (`bg-white rounded-lg border shadow-sm`)
    - 현재 TMS 색상 팔레트 유지
    - 탭 전환 시 하단 리스트 영향 없음
  - **통합**:
    - `PlanDetailPage3Column`에 통합
    - 기존 Test Run Info Header 대체
    - 테이블을 카드 형태로 감쌈
    - 전체 배경: `bg-slate-50`

- [x] **다색 도넛 차트 및 스택형 프로그레스바 구현 (2025-11-28 추가)**:
  - **MultiColorDonutChart.tsx**: 상태별 비율에 따른 다색 세그먼트 도넛
    - SVG Path 기반 구현
    - 각 상태의 개수 → 각도 변환 → Arc Path 생성
    - 고정 순서: Passed → In Progress → Failed → Blocked → Not Run
    - 중앙에 완료율 (Passed 기준) 표시
    - 완벽한 원형 (`viewBox="0 0 100 100"`)
  - **StackedProgressBar.tsx**: 상태별 누적 막대
    - 하나의 막대 안에 5가지 상태 비율로 표시
    - 좌측 Test Runs 목록에 적용
    - 색상 및 순서 일관성 유지
  - **RunStatusLegend.tsx**: 상태별 범례 리스트
    - 고정 순서: Passed → In Progress → Failed → Blocked → Not Run
    - 형식: `[색상 점] [상태명] [개수] ([%])`
    - 자연스러운 타이포그래피 및 간격
  - **색상 팔레트**: 
    - Passed: `#10B981` (녹색)
    - In Progress: `#F59E0B` (노랑)
    - Failed: `#EF4444` (빨강)
    - Blocked: `#4B5563` (진한 회색)
    - Not Run: `#CBD5E1` (연한 회색)

- [x] **Bulk Select/Edit 기능 및 스크롤 구조 개선 (2025-11-28 최종)**:
  - **스크롤 구조 개선**:
    - 문제: 중앙 패널에 스크롤바 2개 (전체 + 테이블)
    - 해결: Summary 고정 (`flex-shrink-0`), Table만 스크롤 (`flex-1 overflow-y-auto`)
    - 레이아웃: `flex flex-col` → Summary (고정) + Table Card (가변)
    - `min-h-0`: Flexbox 자식이 부모 높이 초과 방지
  - **Bulk Select 기능**:
    - 체크박스 추가 (테이블 헤더 + 각 행)
    - 전체 선택/해제 버튼
    - 선택 상태: `Set<string>` 사용
    - 선택된 행 하이라이트: `bg-indigo-50/30`
    - 체크박스 이벤트 전파 방지 (`stopPropagation`)
  - **Bulk Edit 기능**:
    - Bulk Actions Bar (선택 시만 표시, `bg-indigo-50`)
    - Assignee 일괄 변경 드롭다운
    - Status 일괄 변경 드롭다운
    - Apply 버튼 (disabled 처리)
    - API: `bulkUpdatePlanItems()`
    - 업데이트 후 Summary & 프로그레스바 자동 반영
  - **UI/UX 개선**:
    - Toolbar 선택 개수 표시 ("N selected")
    - 확인 다이얼로그 ("Update N test case(s)?")
    - 성공 후 선택 해제 및 초기화
    - 우측 패널과 체크박스 독립적 작동
  - **문서**: `frontend/BULK_SELECT_EDIT_GUIDE.md` 생성

## 3. 데이터베이스 스키마 (Prisma)
```prisma
model User {
  id, email, password, name, role, status, ...
}

model Folder {
  id, name, parentId, parent, children[], testCases[], ...
}

model TestCase {
  id, title, description, priority, folderId, planItems[], ...
}

model Plan {
  id, name, description, status, createdBy, items[], ...
}

model PlanItem {
  id, planId, testCaseId, assignee, result, comment, executedAt, ...
}
```

## 4. 주요 파일 및 구조

### Backend
- `backend/src/controllers/`: authController, adminController, folderController, testcaseController, planController
- `backend/src/routes/`: auth, admin, folders, testcases, plans

### Frontend - 컴포넌트
- `frontend/src/components/`:
  - **레이아웃**: `Layout.tsx`, `Sidebar.tsx`, `Header.tsx`
  - **UI 컴포넌트**: `ui/Button.tsx`, `ui/Card.tsx`, `ui/Badge.tsx`, `ui/Input.tsx`
  - **기능 컴포넌트**: `Navbar.tsx`, `FolderTree.tsx`, `CsvImportModal.tsx`, `CreateTestCaseModal.tsx`

### Frontend - 페이지
- `frontend/src/pages/`:
  - `LoginPage.tsx`, `RegisterPage.tsx` (인증)
  - `TestCasesPage.tsx` (테스트 케이스 관리)
  - `PlansPage.tsx`, `CreatePlanPage.tsx`, `PlanDetailPage.tsx` (테스트 플랜)
  - `AdminPage.tsx` (사용자 관리)

### 테스트
- `tests/`: auth.spec.ts, plan_execution.spec.ts

## 5. 현재 상태 및 이슈
- **상태:** 전체 UI/UX 리디자인 + 3-컬럼 레이아웃 + Bulk Select/Edit 기능 완료. 엔터프라이즈급 SaaS 제품 수준의 인터페이스 구현 완료.
- **최근 이벤트 (2025-11-28)**:
  - TestRail 스타일의 전문적인 SaaS UI로 전환 완료
  - 3-컬럼 레이아웃 구현 (Test Runs / Summary + Table / Details)
  - 다색 도넛 차트 및 스택형 프로그레스바 구현 (SVG Path 기반)
  - Bulk Select/Edit 기능 추가 (체크박스 + 일괄 변경)
  - 스크롤 구조 개선 (Summary 고정 + Table만 스크롤)
  - 사이드바 네비게이션 구조 도입
  - 재사용 가능한 UI 컴포넌트 라이브러리 구축
  - Tailwind CSS 버전 충돌 해결 (v4 → v3.4.1)
  - 모든 페이지 마이그레이션 완료 (7개 페이지)
  - 8개의 상세 가이드 문서 생성 (총 2,500+ 줄)
- **Git 커밋 완료**:
  - 커밋 해시: `bcb2390`
  - 51개 파일 변경 (6,957줄 추가, 768줄 삭제)
  - GitHub: https://github.com/koesnuj/TMS_v2
- **조치 필요:**
  - 없음. 시스템 안정적이며 새로운 디자인 및 기능 적용 완료.

## 6. 다음 단계
1. **대시보드 (Dashboard):**
   - 홈페이지에 통계 위젯 추가 (총 테스트 케이스, 플랜 수, 최근 실행 결과)
   - 최근 활동 타임라인
   - 진행 중인 플랜 카드 목록

2. **리포팅 (Reporting):**
   - 플랜별 실행 결과 리포트 페이지
   - 차트 라이브러리 통합 (Recharts 또는 Chart.js)
   - PDF/Excel 내보내기 기능
   - 기간별 트렌드 분석 (성공률, 결함 발견율)

3. **테스트 케이스 편집/삭제:**
   - 테스트 케이스 수정 모달
   - 삭제 확인 다이얼로그
   - 이력 관리 (Audit Log)

4. **고급 기능:**
   - 플랜 복제 및 재실행
   - 테스트 케이스 템플릿
   - Drag & Drop으로 케이스 순서 변경
   - 이미지 첨부 기능 (현재는 텍스트만)
   - 사용자별 알림 시스템 (Slack/Email 연동)

5. **성능 최적화:**
   - 대규모 플랜을 위한 가상 스크롤링 (React Virtualized)
   - 페이지네이션 또는 무한 스크롤
   - 검색 기능 강화 (Fuzzy Search, 전체 텍스트 검색)
   - 캐싱 전략 (React Query 도입 고려)

6. **CI/CD 파이프라인:**
   - GitHub Actions 설정
   - 자동 테스트 실행 (Playwright)
   - 자동 배포 (Vercel/Netlify 또는 Docker)

7. **모바일 최적화:**
   - 반응형 디자인 개선 (< 1024px)
   - 터치 제스처 지원
   - 모바일 전용 네비게이션

8. **API 개선:**
   - GraphQL 전환 고려 (Over-fetching 문제 해결)
   - Webhook 지원 (외부 시스템 연동)
   - Rate Limiting 및 보안 강화
